<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>plumetrack.gui.main &mdash; Plumetrack 15.01 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '15.01',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/plumetrack_32.ico"/>
    <link rel="top" title="Plumetrack 15.01 documentation" href="../../../index.html" />
    <link rel="up" title="plumetrack" href="../../plumetrack.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">Plumetrack 15.01 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../plumetrack.html" accesskey="U">plumetrack</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for plumetrack.gui.main</h1><div class="highlight"><pre>
<span class="c">#Copyright (C) Nial Peters 2014</span>
<span class="c">#</span>
<span class="c">#This file is part of plumetrack.</span>
<span class="c">#</span>
<span class="c">#plumetrack is free software: you can redistribute it and/or modify</span>
<span class="c">#it under the terms of the GNU General Public License as published by</span>
<span class="c">#the Free Software Foundation, either version 3 of the License, or</span>
<span class="c">#(at your option) any later version.</span>
<span class="c">#</span>
<span class="c">#_plumetrack is distributed in the hope that it will be useful,</span>
<span class="c">#but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c">#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c">#GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c">#You should have received a copy of the GNU General Public License</span>
<span class="c">#along with plumetrack.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">wx.html</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;wxagg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span>

<span class="kn">from</span> <span class="nn">wx.lib.agw</span> <span class="kn">import</span> <span class="n">floatspin</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_wxagg</span> <span class="kn">import</span> <span class="n">FigureCanvasWxAgg</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>

<span class="kn">import</span> <span class="nn">plumetrack</span>
<span class="kn">from</span> <span class="nn">plumetrack</span> <span class="kn">import</span> <span class="n">settings</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span>  <span class="n">persist</span>
<span class="kn">from</span> <span class="nn">plumetrack.gui</span> <span class="kn">import</span> <span class="n">artwork</span><span class="p">,</span> <span class="n">batch_processor</span><span class="p">,</span> <span class="n">interactive_viewer</span>


<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the main program - this is set as the entry point for the configuration</span>
<span class="sd">    utility in the setup.py file.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">app</span> <span class="o">=</span> <span class="n">PlumetrackApp</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>
    


<span class="c">###############################################################</span>
<span class="c"># Here we subclass a bunch of wx widgets so that when their values</span>
<span class="c"># change they call the on_config_change method of the main frame to trigger</span>
<span class="c"># an update to the interactive_viewer (if it exists).</span></div>
<div class="viewcode-block" id="AutoUpdate"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdate">[docs]</a><span class="k">class</span> <span class="nc">AutoUpdate</span><span class="p">:</span>
<div class="viewcode-block" id="AutoUpdate.on_change"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdate.on_change">[docs]</a>    <span class="k">def</span> <span class="nf">on_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">GetApp</span><span class="p">()</span><span class="o">.</span><span class="n">main_frame</span><span class="o">.</span><span class="n">on_config_change</span><span class="p">()</span>
        <span class="n">evnt</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>    

</div></div>
<div class="viewcode-block" id="AutoUpdateCheckbox"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateCheckbox">[docs]</a><span class="k">class</span> <span class="nc">AutoUpdateCheckbox</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">,</span> <span class="n">AutoUpdate</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AutoUpdateCheckbox</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_change</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="AutoUpdateChoice"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateChoice">[docs]</a><span class="k">class</span> <span class="nc">AutoUpdateChoice</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Choice</span><span class="p">,</span> <span class="n">AutoUpdate</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AutoUpdateChoice</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHOICE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_change</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="AutoUpdateFloatspin"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateFloatspin">[docs]</a><span class="k">class</span> <span class="nc">AutoUpdateFloatspin</span><span class="p">(</span><span class="n">floatspin</span><span class="o">.</span><span class="n">FloatSpin</span><span class="p">,</span> <span class="n">AutoUpdate</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AutoUpdateFloatspin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">floatspin</span><span class="o">.</span><span class="n">EVT_FLOATSPIN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_change</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="AutoUpdateSpinCtrl"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateSpinCtrl">[docs]</a><span class="k">class</span> <span class="nc">AutoUpdateSpinCtrl</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">SpinCtrl</span><span class="p">,</span> <span class="n">AutoUpdate</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AutoUpdateSpinCtrl</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_SPINCTRL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_change</span><span class="p">)</span> 

</div>
<div class="viewcode-block" id="AutoUpdateTextCtrl"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateTextCtrl">[docs]</a><span class="k">class</span> <span class="nc">AutoUpdateTextCtrl</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">,</span> <span class="n">AutoUpdate</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AutoUpdateTextCtrl</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_updated</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_change</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_change</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_text_change</span><span class="p">)</span>
    
<div class="viewcode-block" id="AutoUpdateTextCtrl.on_change"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateTextCtrl.on_change">[docs]</a>    <span class="k">def</span> <span class="nf">on_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_updated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_updated</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">AutoUpdate</span><span class="o">.</span><span class="n">on_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="AutoUpdateTextCtrl.on_text_change"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateTextCtrl.on_text_change">[docs]</a>    <span class="k">def</span> <span class="nf">on_text_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_updated</span><span class="o">=</span><span class="bp">True</span>
    </div>
<div class="viewcode-block" id="AutoUpdateTextCtrl.SetValue"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.AutoUpdateTextCtrl.SetValue">[docs]</a>    <span class="k">def</span> <span class="nf">SetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override the base class method so that using SetValue does not make the </span>
<span class="sd">        control think that something has changed. Otherwise newly loaded config</span>
<span class="sd">        files will look as though they need to be saved before they are edited.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_updated</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c">########################################################################</span>

</div></div>
<div class="viewcode-block" id="PlumetrackApp"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.PlumetrackApp">[docs]</a><span class="k">class</span> <span class="nc">PlumetrackApp</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        wxApp for the plumetrack configuration program. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_frame</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="nb">super</span><span class="p">(</span><span class="n">PlumetrackApp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
    
    
<div class="viewcode-block" id="PlumetrackApp.OnInit"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.PlumetrackApp.OnInit">[docs]</a>    <span class="k">def</span> <span class="nf">OnInit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">options</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_cmd_line</span><span class="p">()</span>
        
        <span class="c">#register our art provider to serve the Plumetrack icons</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">artwork</span><span class="o">.</span><span class="n">PlumetrackArtProvider</span><span class="p">())</span>
        
        <span class="c">#launch the GUI!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_frame</span> <span class="o">=</span> <span class="n">MainFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetTopWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_frame</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prev_cfg_file</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prev_cfg_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
        
        <span class="bp">self</span><span class="o">.</span><span class="n">main_frame</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span><span class="n">prev_cfg_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>

</div>
    <span class="k">def</span> <span class="nf">_parse_cmd_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function parses the command line input and returns a tuple</span>
<span class="sd">        of (options, args)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">usage</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;%prog [options] [config. file]&quot;</span><span class="p">)</span>
        
        <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
        
        <span class="n">parser</span><span class="o">.</span><span class="n">prog</span> <span class="o">=</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">usage</span> <span class="o">=</span> <span class="n">usage</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">LONG_DESCRIPTION</span>
        
        <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;--version&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;callback&quot;</span><span class="p">,</span> 
                  <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__print_version_and_exit</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;Print Plumetrack&quot;</span>
                  <span class="s">&quot; version number and license information and exit.&quot;</span><span class="p">))</span>
        
        
        <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Only one config file can be specified. Files with &quot;</span>
                         <span class="s">&quot;spaces in their names should be enclosed in quotation marks&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Cannot open config file </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s">. No such file.&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        
        
        <span class="k">return</span> <span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="nf">__print_version_and_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the version number and license information for plumetrack.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> (version </span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">,</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">VERSION</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">COPYRIGHT</span>
        <span class="k">print</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">LICENSE_SHORT</span>
        <span class="k">print</span> <span class="s">&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;Written by </span><span class="si">%s</span><span class="s">.&quot;</span><span class="o">%</span><span class="n">plumetrack</span><span class="o">.</span><span class="n">AUTHOR</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="InputFilesConfig"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.InputFilesConfig">[docs]</a><span class="k">class</span> <span class="nc">InputFilesConfig</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InputFilesConfig</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        
        <span class="n">vsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddGrowableCol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">filename_format_box</span> <span class="o">=</span> <span class="n">AutoUpdateTextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> 
                                                      <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;The format of the filenames of the images to be processed. &quot;</span>
                 <span class="s">&quot;The filenames must include the capture time of the images, &quot;</span>
                 <span class="s">&quot;and the format must be described using the Python strftime &quot;</span>
                 <span class="s">&quot;format. Click the Help button for details of the format. &quot;</span>
                 <span class="s">&quot;The filename format entered here should include &quot;</span>
                 <span class="s">&quot;the file extension.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename_format_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        
        <span class="n">hsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Filename format:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename_format_box</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">format_help_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Help&quot;</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">format_help_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">hsizer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format_help_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_help</span><span class="p">)</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_box</span> <span class="o">=</span> <span class="n">AutoUpdateTextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> 
                                                    <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Custom image loaders allow Plumetrack to be used with image &quot;</span>
                 <span class="s">&quot;formats that are not natively supported, or that require &quot;</span>
                 <span class="s">&quot;customised preprocessing. Enter the filename of your image &quot;</span>
                 <span class="s">&quot;loader here. See the Plumetrack documentation for details.&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span> <span class="o">=</span> <span class="n">AutoUpdateCheckbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Custom image loader:&quot;</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_custom_loader_chkbox</span><span class="p">)</span>
        
        <span class="n">hsizer2</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">hsizer2</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                    <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">hsizer2</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_box</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> 
                    <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_browse_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="n">hsizer2</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_browse_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">hsizer2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_browse_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_browse</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_custom_loader_chkbox</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;File extension:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_extension_box</span> <span class="o">=</span> <span class="n">AutoUpdateTextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> 
                                                     <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;The file extension of your image files to be processed e.g. &quot;</span>
                 <span class="s">&quot;&#39;.png&#39; or &#39;.jpg&#39;. This may be specified with or without the &quot;</span>
                 <span class="s">&quot;preceding dot. It must match the file extension given in the &quot;</span>
                 <span class="s">&quot;filename format box above.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_extension_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_extension_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Pixel size (metres):&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_size_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> 
                                                  <span class="n">max_val</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> 
                                                  <span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;The size of the pixels in the images. Note that this is the &quot;</span>
                 <span class="s">&quot;length in metres along one pixel dimension, not the area of &quot;</span>
                 <span class="s">&quot;the pixel.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_size_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_size_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Downsizing factor:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downsizing_factor</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                          <span class="n">increment</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;A downsizing factor of &gt;1.0 means that images will be&quot;</span>
                 <span class="s">&quot; scaled (resized) by this factor before being processed. This &quot;</span>
                 <span class="s">&quot;results in a less accurate flux estimate, but increased &quot;</span>
                 <span class="s">&quot;processing speed.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downsizing_factor</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">downsizing_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Units conversion factor:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux_conversion_factor</span> <span class="o">=</span> <span class="n">AutoUpdateTextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;This is used in conjunction with the pixel_size parameter to &quot;</span>
                 <span class="s">&quot;convert the pixel values in your images into SO2 masses. You &quot;</span>
                 <span class="s">&quot;need to select a value for this parameter such that SO2_mass &quot;</span>
                 <span class="s">&quot;= pixel_value * pixel_size^2 * flux_conversion_factor. The &quot;</span>
                 <span class="s">&quot;fluxes returned will then have units of SO2-mass-units per &quot;</span>
                 <span class="s">&quot;second.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux_conversion_factor</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux_conversion_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">sizer</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">vsizer</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
    
<div class="viewcode-block" id="InputFilesConfig.on_help"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.InputFilesConfig.on_help">[docs]</a>    <span class="k">def</span> <span class="nf">on_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="n">help_frame</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Filename format help - plumetrack-config &quot;</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">HtmlWindow</span><span class="p">(</span><span class="n">help_frame</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">SetPage</span><span class="p">(</span><span class="n">html_help_str</span><span class="p">)</span>
        <span class="n">help_frame</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="InputFilesConfig.on_browse"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.InputFilesConfig.on_browse">[docs]</a>    <span class="k">def</span> <span class="nf">on_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileSelector</span><span class="p">(</span><span class="s">&quot;Select Python module containing custom loader class&quot;</span><span class="p">,</span>
                                   <span class="n">wildcard</span><span class="o">=</span><span class="s">&quot;*.py&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="InputFilesConfig.on_custom_loader_chkbox"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.InputFilesConfig.on_custom_loader_chkbox">[docs]</a>    <span class="k">def</span> <span class="nf">on_custom_loader_chkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_browse_button</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
     
     </div>
<div class="viewcode-block" id="InputFilesConfig.get_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.InputFilesConfig.get_configs">[docs]</a>    <span class="k">def</span> <span class="nf">get_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">file_extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_extension_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">file_extension</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span> <span class="ow">or</span> <span class="n">file_extension</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">(</span><span class="s">&quot;File extension not specified.&quot;</span><span class="p">)</span>
        
        <span class="c">#make sure that the filename extension includes the dot</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_extension</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">):</span>
            <span class="n">file_extension</span> <span class="o">=</span> <span class="s">&#39;.&#39;</span><span class="o">+</span><span class="n">file_extension</span>
        
        <span class="n">filename_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_format_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">filename_format</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span> <span class="ow">or</span> <span class="n">filename_format</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">(</span><span class="s">&quot;Filename format not specified&quot;</span><span class="p">)</span>
        
        <span class="n">flux_conversion_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux_conversion_factor</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">flux_conversion_factor</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span> <span class="ow">or</span> <span class="n">flux_conversion_factor</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">(</span><span class="s">&quot;Units conversion factor not specified. &quot;</span>
                                       <span class="s">&quot;Use a value of 1.0 if you do not &quot;</span>
                                       <span class="s">&quot;require any conversion.&quot;</span><span class="p">)</span>
        
        <span class="n">downsizing_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsizing_factor</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="n">custom_loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">custom_loader</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
        
        <span class="k">return</span> <span class="p">{</span>
                <span class="s">&#39;filename_format&#39;</span><span class="p">:</span><span class="n">filename_format</span><span class="p">,</span>
                <span class="s">&#39;file_extension&#39;</span><span class="p">:</span><span class="n">file_extension</span><span class="p">,</span>
                <span class="s">&#39;custom_image_loader&#39;</span><span class="p">:</span><span class="n">custom_loader</span><span class="p">,</span>
                <span class="s">&#39;pixel_size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_size_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                <span class="s">&#39;flux_conversion_factor&#39;</span><span class="p">:</span><span class="n">flux_conversion_factor</span><span class="p">,</span>
                <span class="s">&#39;downsizing_factor&#39;</span><span class="p">:</span> <span class="n">downsizing_factor</span>
                <span class="p">}</span>
    
    </div>
<div class="viewcode-block" id="InputFilesConfig.set_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.InputFilesConfig.set_configs">[docs]</a>    <span class="k">def</span> <span class="nf">set_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename_format_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;filename_format&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_extension_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;file_extension&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;custom_image_loader&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">configs</span><span class="p">[</span><span class="s">&#39;custom_image_loader&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_custom_loader_chkbox</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custom_loader_chkbox</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_custom_loader_chkbox</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_size_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;pixel_size&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux_conversion_factor</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%0.3e</span><span class="s">&quot;</span><span class="o">%</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;flux_conversion_factor&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downsizing_factor</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;downsizing_factor&#39;</span><span class="p">])</span>


</div></div>
<div class="viewcode-block" id="MaskingConfig"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig">[docs]</a><span class="k">class</span> <span class="nc">MaskingConfig</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MaskingConfig</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        
        <span class="n">vsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span> <span class="o">=</span> <span class="n">AutoUpdateCheckbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Low pixel threshold:&quot;</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                   <span class="n">digits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Any pixels that are below this threshold will be masked using&quot;</span>
                 <span class="s">&quot; random noise during the motion estimation and will be &quot;</span>
                 <span class="s">&quot;excluded from the flux calculation.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_low_thresh</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span> <span class="o">=</span> <span class="n">AutoUpdateCheckbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;High pixel threshold:&quot;</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                   <span class="n">digits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Any pixels that are above this threshold will be masked using&quot;</span>
                 <span class="s">&quot; random noise during the motion estimation and will be &quot;</span>
                 <span class="s">&quot;excluded from the flux calculation.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_high_thresh</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Mask value mean:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_mean_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                                   <span class="n">digits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Masked pixels (either due to thresholding or a mask image) &quot;</span>
                 <span class="s">&quot;are replaced by Gaussian distributed white noise. This &quot;</span>
                 <span class="s">&quot;parameter controls the mean value of this noise.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_mean_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_mean_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Mask value Std. Dev.:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_sigma_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                     <span class="n">min_val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Masked pixels (either due to thresholding or a mask image) &quot;</span>
                 <span class="s">&quot;are replaced by Gaussian distributed white noise. This &quot;</span>
                 <span class="s">&quot;parameter controls the standard-deviation of this noise. It &quot;</span>
                 <span class="s">&quot;can be set to 0 if masking with a single value is required.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_sigma_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_sigma_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">sizer</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">)</span>
        
        <span class="n">hsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span> <span class="o">=</span> <span class="n">AutoUpdateCheckbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Mask image:&quot;</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span> <span class="o">=</span> <span class="n">AutoUpdateTextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Regions of the image which you do not want to contribute to &quot;</span>
                 <span class="s">&quot;the flux, or that might interfere with the motion estimation &quot;</span>
                 <span class="s">&quot;(for example high-contrast boudaries of the volcanic edifice)&quot;</span>
                 <span class="s">&quot; can be excluded from the calculations by creating a mask &quot;</span>
                 <span class="s">&quot;image. This should be a greyscale image of the same size as &quot;</span>
                 <span class="s">&quot;the UV images to be processed. Any pixels that are black &quot;</span>
                 <span class="s">&quot;(pixel value of 0) in the mask image will be replaced with &quot;</span>
                 <span class="s">&quot;random noise and excluded from the flux calculations. Enter &quot;</span>
                 <span class="s">&quot;the filename of the mask image here.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browse_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Select an existing mask image to use.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browse_button</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_mask_im</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_browse</span><span class="p">)</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">hsizer</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">vsizer</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
    
<div class="viewcode-block" id="MaskingConfig.on_browse"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig.on_browse">[docs]</a>    <span class="k">def</span> <span class="nf">on_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileSelector</span><span class="p">(</span><span class="s">&quot;Select mask image&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            
    </div>
<div class="viewcode-block" id="MaskingConfig.on_mask_im"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig.on_mask_im">[docs]</a>    <span class="k">def</span> <span class="nf">on_mask_im</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browse_button</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_threshold_visibility</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="MaskingConfig.on_low_thresh"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig.on_low_thresh">[docs]</a>    <span class="k">def</span> <span class="nf">on_low_thresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_threshold_visibility</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="MaskingConfig.on_high_thresh"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig.on_high_thresh">[docs]</a>    <span class="k">def</span> <span class="nf">on_high_thresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">update_threshold_visibility</span><span class="p">()</span>
        
        </div>
<div class="viewcode-block" id="MaskingConfig.update_threshold_visibility"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig.update_threshold_visibility">[docs]</a>    <span class="k">def</span> <span class="nf">update_threshold_visibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">enabled</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">()</span> <span class="ow">or</span> 
                   <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">()</span> <span class="ow">or</span> 
                   <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_mean_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_sigma_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="MaskingConfig.set_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig.set_configs">[docs]</a>    <span class="k">def</span> <span class="nf">set_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_low&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_high&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;mask_image&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_mean_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;random_mean&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_sigma_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;random_sigma&#39;</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_low&#39;</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_low&#39;</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">)</span>
                                   
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_high&#39;</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_high&#39;</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;mask_image&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;mask_image&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browse_button</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;mask_image&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">update_threshold_visibility</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="MaskingConfig.get_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MaskingConfig.get_configs">[docs]</a>    <span class="k">def</span> <span class="nf">get_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">configs</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="s">&#39;random_mean&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_mean_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                   <span class="s">&#39;random_sigma&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_sigma_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
                   <span class="p">}</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="n">configs</span><span class="p">[</span><span class="s">&#39;mask_image&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_im_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">configs</span><span class="p">[</span><span class="s">&#39;mask_image&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_thresh_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">configs</span><span class="p">[</span><span class="s">&#39;motion_pix_threshold_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    
        <span class="k">return</span> <span class="n">configs</span>


</div></div>
<div class="viewcode-block" id="MotionTrackingConfig"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MotionTrackingConfig">[docs]</a><span class="k">class</span> <span class="nc">MotionTrackingConfig</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    
        <span class="nb">super</span><span class="p">(</span><span class="n">MotionTrackingConfig</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        
        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Pyramid scale:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyr_scale_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                  <span class="n">increment</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Farneback algorithm parameter: the image scale (&lt;1.0) to &quot;</span>
                 <span class="s">&quot;build pyramids for each image; setting this to 0.5 means a &quot;</span>
                 <span class="s">&quot;classical pyramid, where each next layer is half the size &quot;</span>
                 <span class="s">&quot;of the previous one.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyr_scale_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pyr_scale_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Pyramid levels:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">levels_box</span> <span class="o">=</span> <span class="n">AutoUpdateSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Farneback algorithm parameter: number of pyramid layers &quot;</span>
                 <span class="s">&quot;including the initial image; setting this to 1 means that no &quot;</span>
                 <span class="s">&quot;extra layers are created and only the original images &quot;</span>
                 <span class="s">&quot;are used.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">levels_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>       
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Window size:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">winsize_box</span> <span class="o">=</span> <span class="n">AutoUpdateSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Farneback algorithm parameter: averaging window size; larger &quot;</span>
                 <span class="s">&quot;values increase the algorithm robustness to image noise and &quot;</span>
                 <span class="s">&quot;give more chances for fast motion detection, but yield more &quot;</span>
                 <span class="s">&quot;blurred motion field.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">winsize_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">winsize_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Iterations:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iterations_box</span> <span class="o">=</span> <span class="n">AutoUpdateSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Farneback algorithm parameter: number of iterations the &quot;</span>
                 <span class="s">&quot;algorithm performs at each pyramid level.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iterations_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Polynomial size:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poly_n_box</span> <span class="o">=</span> <span class="n">AutoUpdateSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Farneback algorithm parameter: size of the pixel neighborhood&quot;</span>
                 <span class="s">&quot; used to find polynomial expansion in each pixel; larger &quot;</span>
                 <span class="s">&quot;values mean that the image will be approximated with smoother&quot;</span>
                 <span class="s">&quot; surfaces, yielding more robust algorithm and more blurred &quot;</span>
                 <span class="s">&quot;motion field, typically values of 5 or 7 are used.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poly_n_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_n_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Gaussian smoothing:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> 
                  <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poly_sigma_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                                  <span class="n">increment</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Farneback algorithm parameter: standard deviation of the &quot;</span>
                 <span class="s">&quot;Gaussian that is used to smooth derivatives used as a basis &quot;</span>
                 <span class="s">&quot;for the polynomial expansion; for polynomial sizes of 5 and &quot;</span>
                 <span class="s">&quot;7, reasonable choices of this parameter would be 1.1 and 1.5 &quot;</span>
                 <span class="s">&quot;respectively.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poly_sigma_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poly_sigma_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">sizer</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
    
<div class="viewcode-block" id="MotionTrackingConfig.get_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MotionTrackingConfig.get_configs">[docs]</a>    <span class="k">def</span> <span class="nf">get_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
                <span class="s">&#39;farneback_pyr_scale&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pyr_scale_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                <span class="s">&#39;farneback_levels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                <span class="s">&#39;farneback_winsize&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">winsize_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                <span class="s">&#39;farneback_iterations&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                <span class="s">&#39;farneback_poly_n&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poly_n_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                <span class="s">&#39;farneback_poly_sigma&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poly_sigma_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span>
                <span class="p">}</span>
    
    </div>
<div class="viewcode-block" id="MotionTrackingConfig.set_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MotionTrackingConfig.set_configs">[docs]</a>    <span class="k">def</span> <span class="nf">set_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pyr_scale_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;farneback_pyr_scale&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">levels_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;farneback_levels&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">winsize_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;farneback_winsize&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iterations_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;farneback_iterations&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poly_n_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;farneback_poly_n&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poly_sigma_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;farneback_poly_sigma&#39;</span><span class="p">])</span>
 
 </div></div>
<div class="viewcode-block" id="IntegrationLineConfig"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineConfig">[docs]</a><span class="k">class</span> <span class="nc">IntegrationLineConfig</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IntegrationLineConfig</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num</span> <span class="o">=</span> <span class="n">num</span>
        
        <span class="n">vsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
      
        <span class="n">hsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Name:&quot;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span> <span class="o">=</span> <span class="n">AutoUpdateTextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;Integration Line </span><span class="si">%d</span><span class="s">&quot;</span><span class="o">%</span><span class="n">num</span><span class="p">)</span>
        
        <span class="n">h_txt</span> <span class="o">=</span>  <span class="p">(</span><span class="s">&quot;Descriptive name for this integration line. This will appear&quot;</span>
                  <span class="s">&quot; as a column heading in plumetrack results files&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name_box</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Points:&quot;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span> <span class="o">=</span> <span class="n">AutoUpdateTextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span>  <span class="p">(</span><span class="s">&quot;List of [x, y] points (e.g. [[x1, y1], [x2, y2],...]) &quot;</span>
                  <span class="s">&quot;defining the integration line for the flux calculation. x &quot;</span>
                  <span class="s">&quot;and y are in pixel coordinates - the origin is in the top &quot;</span>
                  <span class="s">&quot;left of an image.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Draw&quot;</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Opens a dialog in which the integration line can be chosen by&quot;</span>
                 <span class="s">&quot; drawing it onto an image.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_button</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">hsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_button</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_draw</span><span class="p">)</span>
         
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">hsizer</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
         
        <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span> <span class="o">=</span> <span class="n">AutoUpdateCheckbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Reverse integration direction&quot;</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Defines which way is positive across the integration line. &quot;</span>
                 <span class="s">&quot;This is easier to set in the &#39;Draw&#39; dialog (click button &quot;</span>
                 <span class="s">&quot;above).&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">vsizer</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
            
<div class="viewcode-block" id="IntegrationLineConfig.on_draw"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineConfig.on_draw">[docs]</a>    <span class="k">def</span> <span class="nf">on_draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="n">image_file</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileSelector</span><span class="p">(</span><span class="s">&quot;Choose image file to draw integration line on&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">image_file</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_UNCHANGED</span><span class="p">)</span> 
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s">&quot;Failed to open &#39;</span><span class="si">%s</span><span class="s">&#39;. Error was: </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">ex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">pts</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="c">#get any other integration line points from the parent frame</span>
        <span class="n">other_pts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Parent</span><span class="o">.</span><span class="n">get_other_int_line_pts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num</span><span class="p">)</span>
        
        <span class="n">int_line_dialog</span> <span class="o">=</span> <span class="n">IntegrationLineSelectDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Parent</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">pts</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">other_pts</span><span class="o">=</span><span class="n">other_pts</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">int_line_dialog</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
            <span class="n">int_line</span> <span class="o">=</span> <span class="n">int_line_dialog</span><span class="o">.</span><span class="n">get_integration_line</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">int_line</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">int_line</span><span class="p">))</span>
                
            <span class="n">direction</span> <span class="o">=</span> <span class="n">int_line_dialog</span><span class="o">.</span><span class="n">get_integration_direction</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            
            <span class="c">#manually call on config change to update int lines in config test </span>
            <span class="c">#frame (if it exists)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">GetApp</span><span class="p">()</span><span class="o">.</span><span class="n">main_frame</span><span class="o">.</span><span class="n">on_config_change</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="IntegrationLineConfig.set_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineConfig.set_configs">[docs]</a>    <span class="k">def</span> <span class="nf">set_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_direction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Unexpected value (</span><span class="si">%d</span><span class="s">) for integration_direction. &quot;</span>
                             <span class="s">&quot;Expected -1 or 1.&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_direction&#39;</span><span class="p">]))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_points&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">])</span>
    
    </div>
<div class="viewcode-block" id="IntegrationLineConfig.get_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineConfig.get_configs">[docs]</a>    <span class="k">def</span> <span class="nf">get_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        
        <span class="n">int_line_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">integration_line_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">int_line_str</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ow">or</span> <span class="n">int_line_str</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">(</span><span class="s">&quot;No points specified for integration &quot;</span>
                                       <span class="s">&quot;line </span><span class="si">%d</span><span class="s">.&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_num</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">integration_points</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">int_line_str</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">(</span><span class="s">&quot;Invalid format for integration line </span><span class="si">%d</span><span class="s"> &quot;</span>
                                       <span class="s">&quot;points. Expecting [[x1, y1], &quot;</span>
                                       <span class="s">&quot;[x2, y2],...]&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_num</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">{</span>
                <span class="s">&#39;name&#39;</span> <span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s">&#39;integration_points&#39;</span><span class="p">:</span> <span class="n">integration_points</span><span class="p">,</span>
                <span class="s">&#39;integration_direction&#39;</span><span class="p">:</span> <span class="n">direction</span>
                <span class="p">}</span>

</div></div>
<div class="viewcode-block" id="FluxCalculationConfig"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.FluxCalculationConfig">[docs]</a><span class="k">class</span> <span class="nc">FluxCalculationConfig</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FluxCalculationConfig</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">__integration_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s">u&#39;2d&#39;</span><span class="p">,</span> <span class="s">u&#39;1d&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_int_line_szrs</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        
        <span class="n">gsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">gsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Integration method:&quot;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_method_choice</span> <span class="o">=</span> <span class="n">AutoUpdateChoice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__integration_methods</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Method used to calculate the flux. &#39;1d&#39; is marginally faster,&quot;</span>
                 <span class="s">&quot; but &#39;2d&#39; is more robust, especially for images with a large &quot;</span>
                 <span class="s">&quot;time gaps between them.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_method_choice</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">gsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_method_choice</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        
        <span class="n">gsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span> <span class="o">=</span> <span class="n">AutoUpdateCheckbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Low pixel threshold:&quot;</span><span class="p">)</span>
        <span class="n">gsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span> <span class="o">=</span> <span class="n">AutoUpdateFloatspin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                                   <span class="n">digits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Any pixels that are below this threshold will be excluded &quot;</span>
                 <span class="s">&quot;from the flux calculation. However, this does not affect their&quot;</span>
                 <span class="s">&quot; visibility to the motion estimation algorithm (unlike the &quot;</span>
                 <span class="s">&quot;threshold in the Image Masking section above).&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        <span class="n">gsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_low_thresh</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">gsizer</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Add&quot;</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Add an extra integration line.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Remove&quot;</span><span class="p">)</span>
        <span class="n">h_txt</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Remove the last integration line.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_button</span><span class="o">.</span><span class="n">SetToolTipString</span><span class="p">(</span><span class="n">h_txt</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_add_int_line</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_remove_int_line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_button</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">on_add_int_line</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        
        
<div class="viewcode-block" id="FluxCalculationConfig.get_other_int_line_pts"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.FluxCalculationConfig.get_other_int_line_pts">[docs]</a>    <span class="k">def</span> <span class="nf">get_other_int_line_pts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the points in all the other integration lines except &#39;num&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        
        <span class="n">pts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="n">num</span><span class="p">:</span>
                <span class="k">continue</span>
            
            <span class="n">int_line_str</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">integration_line_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">int_line_str</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="ow">or</span> <span class="n">int_line_str</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                <span class="k">continue</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">integration_points</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">int_line_str</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integration_points</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">pts</span>
        
        
        </div>
<div class="viewcode-block" id="FluxCalculationConfig.on_low_thresh"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.FluxCalculationConfig.on_low_thresh">[docs]</a>    <span class="k">def</span> <span class="nf">on_low_thresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">())</span>
    
    </div>
<div class="viewcode-block" id="FluxCalculationConfig.on_add_int_line"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.FluxCalculationConfig.on_add_int_line">[docs]</a>    <span class="k">def</span> <span class="nf">on_add_int_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="n">num_of_int_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IntegrationLineConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_of_int_lines</span><span class="p">))</span>
        
        <span class="c">#create the configuration panels and add them to the top panel using a </span>
        <span class="c">#box sizer to control the layout</span>
        <span class="n">static_szr</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&#39;Integration Line </span><span class="si">%d</span><span class="s">&#39;</span><span class="o">%</span><span class="n">num_of_int_lines</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">static_szr</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">GetItemIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">static_szr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_int_line_szrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">static_szr</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_button</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="n">static_szr</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Parent</span><span class="o">.</span><span class="n">SendSizeEvent</span><span class="p">()</span>
        
        </div>
<div class="viewcode-block" id="FluxCalculationConfig.on_remove_int_line"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.FluxCalculationConfig.on_remove_int_line">[docs]</a>    <span class="k">def</span> <span class="nf">on_remove_int_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">Remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_line_szrs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_int_line_szrs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">line</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_button</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">button_sizer</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsizer</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Parent</span><span class="o">.</span><span class="n">SendSizeEvent</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="FluxCalculationConfig.get_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.FluxCalculationConfig.get_configs">[docs]</a>    <span class="k">def</span> <span class="nf">get_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="n">low_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">low_thresh</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                 
        <span class="n">int_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__integration_methods</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_method_choice</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()]</span>
        
        <span class="n">integration_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_configs</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="p">{</span>
                <span class="s">&#39;integration_pix_threshold_low&#39;</span><span class="p">:</span> <span class="n">low_thresh</span><span class="p">,</span>
                <span class="s">&#39;integration_method&#39;</span><span class="p">:</span> <span class="n">int_method</span><span class="p">,</span>
                <span class="s">&#39;integration_lines&#39;</span><span class="p">:</span> <span class="n">integration_lines</span>
                <span class="p">}</span>
    
    </div>
<div class="viewcode-block" id="FluxCalculationConfig.set_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.FluxCalculationConfig.set_configs">[docs]</a>    <span class="k">def</span> <span class="nf">set_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
        <span class="c">#set the flux calculation configs</span>
        <span class="n">int_method_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__integration_methods</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_method&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_method_choice</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="n">int_method_idx</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_pix_threshold_low&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_pix_threshold_low&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">low_thresh_box</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="c">#now set the configs for all the integration lines that are defined</span>
        
        <span class="c">#first remove any extra lines</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_remove_int_line</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        
        <span class="c">#now set the configs for the first one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_configs</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_lines&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="c">#and now for the rest (if there are any more)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_lines&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_lines&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_add_int_line</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_int_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_configs</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s">&#39;integration_lines&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
 
 
 </div></div>
<div class="viewcode-block" id="MainToolbar"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainToolbar">[docs]</a><span class="k">class</span> <span class="nc">MainToolbar</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ToolBar</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main program toolbar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_frame</span> <span class="o">=</span> <span class="n">parent</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">__active_figure</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__all_figures</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
        <span class="n">wx</span><span class="o">.</span><span class="n">ToolBar</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">)</span>
        
        <span class="c">#file tools    </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_tool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ART_NEW</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">),</span> <span class="n">shortHelpString</span><span class="o">=</span><span class="s">&quot;New configuration&quot;</span><span class="p">)</span>    
        <span class="bp">self</span><span class="o">.</span><span class="n">open_tool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ART_FILE_OPEN</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">),</span> <span class="n">shortHelpString</span><span class="o">=</span><span class="s">&quot;Open an existing configuration file or import a configuration from a results file.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_tool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ART_FILE_SAVE</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">),</span> <span class="n">shortHelpString</span><span class="o">=</span><span class="s">&quot;Save configuration&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveas_tool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ART_FILE_SAVE_AS</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">),</span> <span class="n">shortHelpString</span><span class="o">=</span><span class="s">&quot;Save configuration with a new file name&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">AddSeparator</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">interactive_tool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="s">&quot;plumetrack_interactive&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">),</span> <span class="n">shortHelpString</span><span class="o">=</span><span class="s">&quot;Open the interactive viewer window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_tool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="s">&quot;plumetrack_process&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">),</span> <span class="n">shortHelpString</span><span class="o">=</span><span class="s">&quot;Batch process images using the current configuration&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Realize</span><span class="p">()</span>
        

        <span class="c">#register events</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_tool</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">parent</span><span class="o">.</span><span class="n">on_new</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_tool</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">parent</span><span class="o">.</span><span class="n">on_save</span><span class="p">)</span>        
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveas_tool</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">parent</span><span class="o">.</span><span class="n">on_saveas</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_tool</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">parent</span><span class="o">.</span><span class="n">on_open_file</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive_tool</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">parent</span><span class="o">.</span><span class="n">on_interactive_viewer</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_TOOL</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_tool</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="n">parent</span><span class="o">.</span><span class="n">on_process</span><span class="p">)</span>
        
    

 </div>
<div class="viewcode-block" id="MainFrame"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame">[docs]</a><span class="k">class</span> <span class="nc">MainFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main frame of the configuration utility GUI.</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&quot; Configuration Utility - &quot;</span><span class="o">+</span><span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_panels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interactive_viewer_frame</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">__current_file</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">MainToolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetToolBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">)</span>
    
    
<div class="viewcode-block" id="MainFrame.launch"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.launch">[docs]</a>    <span class="k">def</span> <span class="nf">launch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prev_cfg_file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create all the GUI elements and show the main window. Note that this </span>
<span class="sd">        needs to be separate from the __init__ method, since we need to set the top</span>
<span class="sd">        level window for wx before calling launch().</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="n">top_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">top_panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ScrolledWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">)</span>
        <span class="n">vsizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">top_panel</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">vsizer</span><span class="p">)</span>
        <span class="n">top_panel</span><span class="o">.</span><span class="n">SetScrollRate</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
        
        <span class="c">#create the configuration panels and add them to the top panel using a </span>
        <span class="c">#box sizer to control the layout </span>
        <span class="n">input_files_static_szr</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="n">top_panel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&#39;Input Files&#39;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_files_config</span> <span class="o">=</span> <span class="n">InputFilesConfig</span><span class="p">(</span><span class="n">top_panel</span><span class="p">)</span>
        <span class="n">input_files_static_szr</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_files_config</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">input_files_static_szr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_panels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_files_config</span><span class="p">)</span>
        <span class="n">input_files_static_szr</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddStretchSpacer</span><span class="p">()</span>
        
        <span class="n">masking_static_szr</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="n">top_panel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&#39;Image Masking&#39;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masking_config</span> <span class="o">=</span> <span class="n">MaskingConfig</span><span class="p">(</span><span class="n">top_panel</span><span class="p">)</span>
        <span class="n">masking_static_szr</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masking_config</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">masking_static_szr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_panels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masking_config</span><span class="p">)</span>
        <span class="n">masking_static_szr</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddStretchSpacer</span><span class="p">()</span>
        
        <span class="n">motion_static_szr</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="n">top_panel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&#39;Motion Estimation&#39;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motion_config</span> <span class="o">=</span> <span class="n">MotionTrackingConfig</span><span class="p">(</span><span class="n">top_panel</span><span class="p">)</span>
        <span class="n">motion_static_szr</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">motion_config</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">motion_static_szr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_panels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">motion_config</span><span class="p">)</span>
        <span class="n">motion_static_szr</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddStretchSpacer</span><span class="p">()</span>
        
        <span class="n">integration_static_szr</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticBoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticBox</span><span class="p">(</span><span class="n">top_panel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&#39;Flux Calculation&#39;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integration_config</span> <span class="o">=</span> <span class="n">FluxCalculationConfig</span><span class="p">(</span><span class="n">top_panel</span><span class="p">)</span>
        <span class="n">integration_static_szr</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_config</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">integration_static_szr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_panels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_config</span><span class="p">)</span>
        <span class="n">integration_static_szr</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
        
        <span class="n">vsizer</span><span class="o">.</span><span class="n">AddSpacer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">top_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">top_panel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="p">)</span>
        
        
        <span class="c">#create a new configuration or load the specified configuration</span>
        <span class="k">if</span> <span class="n">prev_cfg_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_new</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_current_file</span><span class="p">(</span><span class="n">prev_cfg_file</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_new</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        
        <span class="c">#do the layout       </span>
        <span class="n">top_panel</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">vsizer</span><span class="p">)</span>
        <span class="n">top_panel</span><span class="o">.</span><span class="n">SetAutoLayout</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">vsizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">top_sizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetAutoLayout</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">top_sizer</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span> <span class="c">#this fixes the problem of the frame being created too small</span>
        <span class="n">top_sizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">top_panel</span><span class="p">)</span>
        
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>

    </div>
<div class="viewcode-block" id="MainFrame.set_current_file"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.set_current_file">[docs]</a>    <span class="k">def</span> <span class="nf">set_current_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">load_config_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            
                <span class="k">if</span> <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">is_config_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                    <span class="c">#we are importing settings from a results file. Since we don&#39;t </span>
                    <span class="c">#want to overwrite the results file with a config file, we set the </span>
                    <span class="c">#filename to None - forcing the user to do a &quot;save as&quot;.</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="bp">None</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">set_configs</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>    
            <span class="bp">self</span><span class="o">.</span><span class="n">__current_file</span> <span class="o">=</span> <span class="n">filename</span>
            
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&quot;*New Configuration - &quot;</span><span class="o">+</span><span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_needs_saving</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; - &quot;</span><span class="o">+</span><span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">)</span>
                
                <span class="c">#store the last file opened</span>
                <span class="n">persist</span><span class="o">.</span><span class="n">PersistentStorage</span><span class="p">()</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s">&quot;config_script_prev_file&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            
                <span class="bp">self</span><span class="o">.</span><span class="n">set_needs_saving</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">),</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ex</span>     
        
    </div>
<div class="viewcode-block" id="MainFrame.set_needs_saving"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.set_needs_saving">[docs]</a>    <span class="k">def</span> <span class="nf">set_needs_saving</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&quot;*&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetTitle</span><span class="p">()</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;*&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetTitle</span><span class="p">()</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;*&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span> <span class="o">=</span> <span class="n">val</span>
            
            </div>
<div class="viewcode-block" id="MainFrame.get_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.get_configs">[docs]</a>    <span class="k">def</span> <span class="nf">get_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">configs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_panels</span><span class="p">:</span>
            <span class="n">configs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_configs</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="n">configs</span>
    
    </div>
<div class="viewcode-block" id="MainFrame.set_configs"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.set_configs">[docs]</a>    <span class="k">def</span> <span class="nf">set_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_panels</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">set_configs</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>    
    
    </div>
<div class="viewcode-block" id="MainFrame.on_config_change"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_config_change">[docs]</a>    <span class="k">def</span> <span class="nf">on_config_change</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_needs_saving</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive_viewer_frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c">#read the configs from the various input panels        </span>
                <span class="n">configs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_configs</span><span class="p">()</span> 
                
                <span class="c">#check that the configuration is valid</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">validate_config</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                
            <span class="k">except</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
                <span class="k">return</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">interactive_viewer_frame</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="MainFrame.save_unsaved_work"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.save_unsaved_work">[docs]</a>    <span class="k">def</span> <span class="nf">save_unsaved_work</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Would you like to save your changes &quot;</span>
                       <span class="s">&quot;to </span><span class="se">\&#39;</span><span class="s">New Configuration</span><span class="se">\&#39;</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Would you like to save your changes &quot;</span>
                       <span class="s">&quot;to </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s">&quot;</span><span class="o">%</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current_file</span><span class="p">))</span>
        
        <span class="n">ret_val</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">YES_NO</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ret_val</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">YES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_save</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        
    </div>
<div class="viewcode-block" id="MainFrame.on_new"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_new">[docs]</a>    <span class="k">def</span> <span class="nf">on_new</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_unsaved_work</span><span class="p">()</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_configs</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">set_current_file</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="MainFrame.on_open_file"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_open_file">[docs]</a>    <span class="k">def</span> <span class="nf">on_open_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        
        <span class="c">#try to get the name of the last config file opened</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">last_path</span> <span class="o">=</span> <span class="n">persist</span><span class="o">.</span><span class="n">PersistentStorage</span><span class="p">()</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s">&quot;config_script_prev_file&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">last_path</span><span class="o">=</span><span class="s">&quot;&quot;</span>
        
        <span class="n">filename</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileSelector</span><span class="p">(</span><span class="s">&quot;Select configuration file&quot;</span><span class="p">,</span> 
                                   <span class="n">default_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">last_path</span><span class="p">))</span>
        
        <span class="c">#load the configuration parameters from the file</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_unsaved_work</span><span class="p">()</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">set_current_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        
            </div>
<div class="viewcode-block" id="MainFrame.on_process"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_process">[docs]</a>    <span class="k">def</span> <span class="nf">on_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Event handler for batch process toolbar events. Opens the batch </span>
<span class="sd">        processing dialog&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span><span class="p">:</span>
            <span class="n">ret_val</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s">&quot;You must save your changes first. Save changes now?&quot;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ret_val</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
                <span class="k">return</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">on_save</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span><span class="p">:</span>
                <span class="c">#user clicked cancel on save dialog</span>
                <span class="k">return</span>
            
        
        <span class="n">batch_processor</span><span class="o">.</span><span class="n">BatchProcessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_file</span><span class="p">)</span>
        
    </div>
<div class="viewcode-block" id="MainFrame.on_interactive_viewer"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_interactive_viewer">[docs]</a>    <span class="k">def</span> <span class="nf">on_interactive_viewer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Event handler for interactive toolbar events. Opens a directory choice dialog</span>
<span class="sd">        to choose an image directory to test the configs on and then launches </span>
<span class="sd">        a interactive_viewer_frame. Note that if a config test frame already exists</span>
<span class="sd">        then clicking test simply updates the configuration that the config test</span>
<span class="sd">        frame is displaying</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c">#read the configs from the various input panels        </span>
            <span class="n">configs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_configs</span><span class="p">()</span> 
            
            <span class="c">#check that the configuration is valid</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">validate_config</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">prev_dir</span> <span class="o">=</span> <span class="n">persist</span><span class="o">.</span><span class="n">PersistentStorage</span><span class="p">()</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s">&quot;prev_image_dir&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">prev_dir</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        
        <span class="n">im_dir</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">DirSelector</span><span class="p">(</span><span class="s">&quot;Select directory containing images to test the &quot;</span>
                                <span class="s">&quot;configuration on&quot;</span><span class="p">,</span> <span class="n">defaultPath</span><span class="o">=</span><span class="n">prev_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">im_dir</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="n">persist</span><span class="o">.</span><span class="n">PersistentStorage</span><span class="p">()</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s">&quot;prev_image_dir&quot;</span><span class="p">,</span> <span class="n">im_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">interactive_tool</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interactive_viewer_frame</span> <span class="o">=</span> <span class="n">interactive_viewer</span><span class="o">.</span><span class="n">InteractiveViewerFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">im_dir</span><span class="p">,</span> <span class="n">configs</span><span class="p">)</span>
    
    </div>
    <span class="k">def</span> <span class="nf">_on_config_test_frame_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#called from inside the on_close handler of the config test frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interactive_viewer_frame</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">interactive_tool</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;ran on_close handler&quot;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Yield</span><span class="p">()</span>
    
    
<div class="viewcode-block" id="MainFrame.on_cancel"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_cancel">[docs]</a>    <span class="k">def</span> <span class="nf">on_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Event handler for cancel button events. Exits the program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        
    </div>
<div class="viewcode-block" id="MainFrame.on_close"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_close">[docs]</a>    <span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Event handler for close events - exits the program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__needs_saving</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_unsaved_work</span><span class="p">()</span>
        
        <span class="c">#this is a hack for now, since I can&#39;t figure out what component of the </span>
        <span class="c">#InteractiveViewerFrame is not being destroyed properly and is preventing the</span>
        <span class="c">#main application from closing.</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">GetApp</span><span class="p">()</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="MainFrame.on_save"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_save">[docs]</a>    <span class="k">def</span> <span class="nf">on_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Event handler for Save button events. Opens a file selection dialog, </span>
<span class="sd">        reads the configs from the various panels and saves them to the selected</span>
<span class="sd">        file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_saveas</span><span class="p">(</span><span class="n">evnt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__current_file</span><span class="p">)</span>
        
    </div>
<div class="viewcode-block" id="MainFrame.on_saveas"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.on_saveas">[docs]</a>    <span class="k">def</span> <span class="nf">on_saveas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        
        <span class="n">filename</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileSelector</span><span class="p">(</span><span class="s">&quot;Select file to save configuration to&quot;</span><span class="p">,</span> 
                                   <span class="n">flags</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span> <span class="ow">or</span> <span class="n">filename</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">save_to_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        
    </div>
<div class="viewcode-block" id="MainFrame.save_to_file"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.MainFrame.save_to_file">[docs]</a>    <span class="k">def</span> <span class="nf">save_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>     
        <span class="k">try</span><span class="p">:</span>
            <span class="c">#read the configs from the various input panels        </span>
            <span class="n">configs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_configs</span><span class="p">()</span> 
            
            <span class="c">#check that the configuration is valid</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">validate_config</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="n">settings</span><span class="o">.</span><span class="n">ConfigError</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
            <span class="k">return</span>
                      
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ofp</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">ofp</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">persist</span><span class="o">.</span><span class="n">PersistentStorage</span><span class="p">()</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s">&quot;config_script_prev_file&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_current_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_needs_saving</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        
</div></div>
<div class="viewcode-block" id="IntegrationLineSelectDialog"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog">[docs]</a><span class="k">class</span> <span class="nc">IntegrationLineSelectDialog</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">image_array</span><span class="p">,</span> <span class="n">pts</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">other_pts</span><span class="o">=</span><span class="p">[]):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IntegrationLineSelectDialog</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">plumetrack</span><span class="o">.</span><span class="n">PROG_SHORT_NAME</span><span class="o">+</span><span class="s">&quot; Integration Line Selection Tool&quot;</span><span class="p">,</span>
                                                         <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">RESIZE_BORDER</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_DIALOG_STYLE</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">pts</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">int_direction</span> <span class="o">=</span> <span class="n">direction</span>
        
        <span class="n">top_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        
        <span class="n">fig_panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ScrolledWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">fig_panel</span><span class="o">.</span><span class="n">SetScrollRate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">fig_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mpl_figure</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasWxAgg</span><span class="p">(</span><span class="n">fig_panel</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpl_figure</span><span class="p">)</span>
        <span class="n">fig_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        
        <span class="c">#plot the image data into the figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpl_figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        
        <span class="c">#if other integration lines already exist then draw these in</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">other_pts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g--&#39;</span><span class="p">)</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        
        <span class="c">#create blank plots of the integration line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points_plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s">&#39;r.&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">int_direction_lines</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_integration_lines</span><span class="p">()</span>
        
        <span class="n">top_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">fig_panel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_TOP</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        
        <span class="c">#add the buttons to the dialog       </span>
        <span class="n">buttons_sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&#39;Clear&#39;</span><span class="p">)</span>
        <span class="n">buttons_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_clear</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Reverse integration direction&quot;</span><span class="p">)</span>
        <span class="n">buttons_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTRE_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_reverse</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_direction</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction_chkbx</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="n">buttons_sizer</span><span class="o">.</span><span class="n">AddStretchSpacer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_HELP</span><span class="p">,</span> <span class="s">&quot;Help&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancel_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">,</span> <span class="s">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">,</span> <span class="s">&quot;Ok&quot;</span><span class="p">)</span>
        <span class="n">buttons_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">help_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">buttons_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel_button</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">buttons_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">help_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_help</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_cancel</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ok</span><span class="p">)</span>
        <span class="n">top_sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">buttons_sizer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        
        
        <span class="c">#set up the event handling for the line drawing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_click</span><span class="p">)</span>
        
        <span class="c">#self.SetSize(self.Parent.GetSize())</span>
        <span class="c">#self.SendSizeEvent()</span>
    
        <span class="n">fig_panel</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">fig_sizer</span><span class="p">)</span>
        <span class="n">fig_sizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">fig_panel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">top_sizer</span><span class="p">)</span>
        <span class="n">top_sizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">GetApp</span><span class="p">()</span><span class="o">.</span><span class="n">GetTopWindow</span><span class="p">()</span><span class="o">.</span><span class="n">GetSize</span><span class="p">())</span>
        
    
<div class="viewcode-block" id="IntegrationLineSelectDialog.redraw_integration_lines"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.redraw_integration_lines">[docs]</a>    <span class="k">def</span> <span class="nf">redraw_integration_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">points_plt</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_plt</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">)</span>
        
        <span class="c">#remove any old lines</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">int_direction_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_direction_lines</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">l</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>        
            <span class="c">#now draw the new ones</span>
            <span class="n">start_pts_x</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">start_pts_y</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            
            <span class="n">int_line</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="n">IntegrationLine</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_direction</span><span class="p">)</span>
            
            <span class="n">normals</span> <span class="o">=</span> <span class="n">int_line</span><span class="o">.</span><span class="n">get_poly_approx</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
            
            <span class="n">end_pts_x</span> <span class="o">=</span> <span class="n">start_pts_x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">normals</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">end_pts_y</span> <span class="o">=</span> <span class="n">start_pts_y</span> <span class="o">+</span> <span class="p">(</span><span class="mi">20</span><span class="o">*</span> <span class="n">normals</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">end_pts_x</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">int_direction_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">start_pts_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">end_pts_x</span><span class="p">[</span><span class="n">i</span><span class="p">]],[</span><span class="n">start_pts_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">end_pts_y</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="s">&#39;b-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        
        </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.on_reverse"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.on_reverse">[docs]</a>    <span class="k">def</span> <span class="nf">on_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">int_direction</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_integration_lines</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.on_click"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.on_click">[docs]</a>    <span class="k">def</span> <span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">evnt</span><span class="o">.</span><span class="n">inaxes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpl_axes</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="n">evnt</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">evnt</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">evnt</span><span class="o">.</span><span class="n">ydata</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
            
        <span class="k">if</span> <span class="n">evnt</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span> <span class="o">-</span> <span class="n">evnt</span><span class="o">.</span><span class="n">xdata</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span> <span class="o">-</span> <span class="n">evnt</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;bool&#39;</span><span class="p">)</span>
                <span class="n">mask</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">points_plt</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">line_plt</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_integration_lines</span><span class="p">()</span>
             
    </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.on_help"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.on_help">[docs]</a>    <span class="k">def</span> <span class="nf">on_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s">&quot;Left click on the image to add points to the integration&quot;</span>
                      <span class="s">&quot; line. Right clicking on points will remove them. The &quot;</span>
                      <span class="s">&quot;tick marks on the integration line should point in the &quot;</span>
                      <span class="s">&quot;positive flux direction, select </span><span class="se">\&quot;</span><span class="s">Reverse integration &quot;</span>
                      <span class="s">&quot;direction</span><span class="se">\&quot;</span><span class="s"> if they do not. Other integration lines that&quot;</span>
                      <span class="s">&quot; are defined are shown as green dashed lines.&quot;</span><span class="p">,</span> 
                      <span class="s">&quot;plumetrack Integration line help&quot;</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.on_cancel"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.on_cancel">[docs]</a>    <span class="k">def</span> <span class="nf">on_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.on_ok"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.on_ok">[docs]</a>    <span class="k">def</span> <span class="nf">on_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
    
    </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.on_clear"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.on_clear">[docs]</a>    <span class="k">def</span> <span class="nf">on_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evnt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_integration_lines</span><span class="p">()</span>
    
    </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.get_integration_line"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.get_integration_line">[docs]</a>    <span class="k">def</span> <span class="nf">get_integration_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_xpts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_ypts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
    
    </div>
<div class="viewcode-block" id="IntegrationLineSelectDialog.get_integration_direction"><a class="viewcode-back" href="../../../plumetrack.gui.html#plumetrack.gui.main.IntegrationLineSelectDialog.get_integration_direction">[docs]</a>    <span class="k">def</span> <span class="nf">get_integration_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_direction</span>


</div></div>
<span class="n">html_help_str</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">&lt;p&gt;The filenames used for the image files must encode the capture time of the image. The format used to express the capture time is flexible and can be specified using the directives in the table below.&lt;/p&gt;</span>
<span class="s">&lt;p&gt;A few example filenames and their corresponding format strings:&lt;/p&gt;</span>
<span class="s">&lt;p&gt;2013_08_25_234632.png  =&gt; %Y_%m_</span><span class="si">%d</span><span class="s">_%H%M%S.png&lt;/p&gt;</span>
<span class="s">&lt;p&gt;24Jan13_164700_235.png =&gt; </span><span class="si">%d</span><span class="s">%b%y_%H%M%S_</span><span class="si">%f</span><span class="s">.png&lt;/p&gt;</span>
<span class="s">&lt;p&gt;&lt;/p&gt;</span>
<span class="s">&lt;p&gt;A complete list of available format specifiers:&lt;/p&gt;</span>
<span class="s">&lt;table border=&quot;1&quot; class=&quot;docutils&quot;&gt;</span>
<span class="s">&lt;colgroup&gt;</span>
<span class="s">&lt;col width=&quot;22%&quot; /&gt;</span>
<span class="s">&lt;col width=&quot;64%&quot; /&gt;</span>
<span class="s">&lt;/colgroup&gt;</span>
<span class="s">&lt;thead valign=&quot;bottom&quot;&gt;</span>
<span class="s">&lt;tr&gt;&lt;th class=&quot;head&quot;&gt;Directive&lt;/th&gt;</span>
<span class="s">&lt;th class=&quot;head&quot;&gt;Meaning&lt;/th&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;/thead&gt;</span>
<span class="s">&lt;tbody valign=&quot;top&quot;&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%a&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s abbreviated weekday</span>
<span class="s">name.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%A&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s full weekday name.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%b&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s abbreviated month</span>
<span class="s">name.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%B&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s full month name.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;</span><span class="si">%c</span><span class="s">&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s appropriate date and</span>
<span class="s">time representation.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;</span><span class="si">%d</span><span class="s">&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Day of the month as a decimal</span>
<span class="s">number [01,31].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;</span><span class="si">%f</span><span class="s">&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Microsecond as a decimal</span>
<span class="s">number [0,999999], zero-padded</span>
<span class="s">on the left&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%H&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Hour (24-hour clock) as a</span>
<span class="s">decimal number [00,23].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%I&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Hour (12-hour clock) as a</span>
<span class="s">decimal number [01,12].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%j&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Day of the year as a decimal</span>
<span class="s">number [001,366].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%m&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Month as a decimal number</span>
<span class="s">[01,12].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%M&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Minute as a decimal number</span>
<span class="s">[00,59].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%p&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s equivalent of either</span>
<span class="s">AM or PM.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%S&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Second as a decimal number</span>
<span class="s">[00,61].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%U&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Week number of the year</span>
<span class="s">(Sunday as the first day of</span>
<span class="s">the week) as a decimal number</span>
<span class="s">[00,53].  All days in a new</span>
<span class="s">year preceding the first</span>
<span class="s">Sunday are considered to be in</span>
<span class="s">week 0.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%w&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Weekday as a decimal number</span>
<span class="s">[0(Sunday),6].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%W&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Week number of the year</span>
<span class="s">(Monday as the first day of</span>
<span class="s">the week) as a decimal number</span>
<span class="s">[00,53].  All days in a new</span>
<span class="s">year preceding the first</span>
<span class="s">Monday are considered to be in</span>
<span class="s">week 0.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;</span><span class="si">%x</span><span class="s">&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s appropriate date</span>
<span class="s">representation.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;</span><span class="si">%X</span><span class="s">&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Locale&amp;#8217;s appropriate time</span>
<span class="s">representation.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%y&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Year without century as a</span>
<span class="s">decimal number [00,99].&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%Y&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Year with century as a decimal</span>
<span class="s">number.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%z&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;UTC offset in the form +HHMM</span>
<span class="s">or -HHMM (empty string if the</span>
<span class="s">the object is naive).&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;%Z&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;Time zone name (empty string</span>
<span class="s">if the object is naive).&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;tr&gt;&lt;td&gt;&lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;</span><span class="si">%%</span><span class="s">&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;</span>
<span class="s">&lt;td&gt;A literal &lt;tt class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;/tt&gt; character.&lt;/td&gt;</span>
<span class="s">&lt;/tr&gt;</span>
<span class="s">&lt;/tbody&gt;</span>
<span class="s">&lt;/table&gt;&quot;&quot;&quot;</span>           
        
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/plumetrack.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">Plumetrack 15.01 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../plumetrack.html" >plumetrack</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Nial Peters.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>